# Ubuntuのバージョンアップ

## Ubuntu19.10から20.04へのアップグレードと，20.04の新規インストール作業

:CATEGORIES: Linux,Ubuntu

　アップグレードは夕方に始めたように思います。まずはじめにデータのバックアップ以外にほとんど起動することのないディスクトップの古いパソコンにインストールする作業を午後に始めました。しかし，DVDからインストールすることが出来ず，アップグレードを試みました。

　インストールのISOファイルをDVDに書き込むことが出来ず，２枚のDVD-Rをだめにして，夕方に買い物のついでに宇出津新港のアルプの百均で２枚組のDVD-Rと１枚のDVD-RWを買ってきたのですが，これは外付けのプレーヤーに入れても認識をしませんでした。

　買い物から戻ったのが18時を過ぎていて，買い物に出かける前にUSBにインストールディスクを作成していたのですが，古いディスクトップパソコンの方はUSBから起動することが出来ませんでした。数年前，本体のみをタダでもらったパソコンになります。

　もともとデータのバックアップ用にサーバー専用機のような用途をしていたので，ディスクトップのアプリや込み入ったライブラリー余り入れていないので，アップグレードが出来るのではないかと思い調べてみました。

　Ubuntuのシステムのアップグレードは10年以上前，羽咋市に住んでいた頃に2,3度やったことがあったのですが，ライブラリーのバージョンの違いなどで正常に動くことがなく，エラーの対処も多かったので，新規インストール以外はしなくなっていました。

　百均に売っているDVD-Rが古いDVDプレーヤーでは使えない時代となってしまいました。新しい外付けのDVDプレーヤーを買うという方法もありますが，OSのインストールではシステムの最初の起動時にハードディスクやSSD以外からBOOTが出来なければなりません。

　普通に考えて，USBからブートできるのであれば，USB接続のDVDプレーヤーからブートできる可能性はありそうですが，USBからブートできないことを確認したパソコンになるので，できる見込みはありません。

　アップグレードが成功した時間のことは憶えていないですが，昨日の午後から夕方遅くに掛け,4,5時間はその作業に時間を使ったように思います。アップグレードではMySQLのインストールや設定がうまくいかず，それにもかなり時間を掛けていました。

　あとでUbuntu20.04の新規インストールをした時は，余り問題が起きなかったのですが，アップグレードの場合は，ネットで調べながらけっこう面倒な作業を行いました。MySQLのバージョンが上がったためで，他にもコマンドの書式に変更点があったようです。

» Ubuntu　20.04　MySQL - Google 検索 https://t.co/gVGMo1OIIF

» Ubuntu 20.04にMySQL 8.0をインストール（OS標準） - Qiita https://t.co/SdV1RDvlks

» Linuxディストリビューション「Ubuntu 20.04 LTS」リリース、2年ぶりの長期サポート版 - クラウド Watch https://t.co/gQEmt3K3mw

　あらためて調べても，MySQLのバージョンアップは情報が乏しく関心も少ないようですが，バージョンが８になって処理速度が２倍になったという話がありました。確かに処理速度は早くなったような実感があります。

　pythonのデフォルトが２系から３系になるという話は前に見かけていたのですが，MySQLのバージョンアップは情報を見かけることがなく，今調べてもごくわずかな情報です。データベースの移行もうまくはいったのですが，すんなりとはいかず，色々やっていました。

　今回，Ubuntu20.04の新規インストールをしたのはメインで使っているディスクトップパソコンですが，19.04で使っていたパーティションを初期化するかたちでインストールしました。昨日までメインで使っていた18.04は，そのまま残っています。

　18.04をインストールしていたのは2.5インチの100GBほどのSSDで，値段も3千円より安かったかもしれません。Amazonで購入しました。移行した20.04のUbuntuに問題がなければ，ノートパソコンに取り付け，そちらにも20.04の新規インストールを考えています。

　ここ数年，Ubuntuのバージョンアップにトラブルは少なくなっているのですが，今回も思わぬところで不具合が出たり対処を迫られてました。のんびりやっていたのですが，午前4時半ぐらいまで，その後の設定作業などをやっていました。

　今朝になって気がついたのですが，Emacsでも多少の不具合があって，その１つがフォントの大きさになります。フォントの設定はネットで探してもいくつかの方法があるのですが，設定が通用する場合としない場合があって，今回もやや不満を残したままの状態となっています。

　単純に日本語のフォントサイズが大きくなったのですが，設定で改善はみられるものの，なぜか空行の幅が大きいのです。なぜか，フォントを変更するメニューも出てきません。Emacsのインストールが不完全なのかもしれません。

　Ubuntuのバージョンアップは一年に2回あって，4月と10月になります。今回は2020年4月を意味する20.04というバージョンです。今回はLTSということでサポート期間の長いバージョンです。

　19.10もインストールした環境があったのですが，19.04ではサポート切れでアップデートが出来ない状態となっていました。長年，Ubuntuを使ってきましたが，これは19.04が初めてのことでした。

　以前は，半年に1回，Ubuntuの新規インストールを決まって行っていたのですが，昨年あたりから18.04のLTSをそのまま使い続けるようにもなっていました。なにかとトラブルも起こり，時間と手間の掛かる作業になりますが，繰り返し学ぶ，勉強の機会ともなります。

　UbuntuなどのLinuxの場合，Windowsパソコンのようにインストールディスクに使うということはなく，インターネット接続の環境さえあれば，いつでもインストールや更新が出来る仕組みとなっています。

## ディスクトップパソコンのSSDを取り外し，ノートパソコンに取り付けてUbuntu20.04LTSを新規インストール（2020年5月3日）

　ディスクトップパソコンには２つのSSDと１つのハードディスクを内蔵で取り付けていたのですが，SSDを１つ取り外したところ，BIOSが起動しなくなりました。

　少し知識はあったCMOSクリアというのを実行して起動できるようになったのですが，昨年の10月ころにSSDが故障し，その悪夢の再来かと最初は衝撃でした。静電気で壊れた可能性を考えたのですが，2009年1月に自作パソコンのマザーボードをショートでダメにしたこともありました。

　その時は，羽咋市のアパートから車で金沢市内の同じパソコン店に別のマザーボードを買いに走ったのですが，それが自分の車で自分で運転をして金沢市に行った最後の機会にもなっていると思います。1月の中頃か20日前後だったと思います。羽咋市には3月15日までいました。

　CMOSの電池というのもパソコンの知識として持っていたのですが，実際に交換したのは初めてのことで，宇出津新港のアルプの百均で買ってきたのですが百均で2個入りでした。百均で買える電池というのも全く知らずにいました。

　他にも買い物をして，家に戻ったところで一度，パソコンのBIOSが起動したのですが，ホームセンターでエアークリーナーを買ってきていたので，ホコリの掃除をしてから続きをやろうと電源を落としてしまいました。それから長い時間，またBIOSが起動しなくなりました。

　ノートパソコンにはインストール用のUSBでUbuntu20.04を起動していて，YouTubeでCMOSクリアの動画などを視聴していました。自動再生がオンになっていて，そのままにしていたので，他に作業などしながらラジオを聴くような感じで，意外なパソコンの話を聴いていました。

　ときどき動画の方もみていたのですが，CMOSクリアはパソコンを完全に放電させるのが大事なことで，6時間以上おいてようやく成功したという話もありました。

　20時ぐらいにはようやくBIOSが起動しましたが，買い物から戻ってすぐに見たのと同じヤバそうな画面でした。しかし，調べてみると単にBIOSの初期化設定を促す画面で，回復につながる希望の橋だったわけです。

```
パソコンの電源を入れると「American Megatrends ……」（アメリカンメガトレンド）とエラーメッセージが表示されてパソコンが起動できないトラブルに遭遇したことがありますか。

［source：］起動時に「American Megatrends ……」と表示された場合の対処法 https://www.partitionwizard.jp/partitionmagic/solution-to-american-megatrends-error.html
```

　10年以上前に似たような画面をパソコンの起動時に見たような気もするのですが，ハードウェア構成の変更でBIOSが起動しなくなったり，初期化を促されたというのは初めての経験だったと思います。自作のパソコンばかりやっていた時期もあるので，今まで経験することがなかった方が不思議でした。

　そのあとも経験したことのないトラブルが続き，Ubuntuが正常に起動しない状態でした。最終的には/etc/fastbという設定ファイルで，マウントするパーティションのUUIDを書き換えることで解決したのですが，ドライブが３つあったときの設定が残っていました。

　Linuxのブート（起動）のトラブルは，これまでに何度か経験していて，GRUBというブートマネージャーをコマンド操作し，直接，カーネルを起動することは何度かやっていました。この場合，キーボードの配列が英語のものとなるので，特殊文字の配置が全く変わってきます。

 - 2020-05-03_180853＿.jpg \n 2020-05-03_181537＿.jpg \n 2020-05-03_194255＿.jpg \n 2020-05-03_195156＿.jpg https://t.co/MCV9iiWtzx

 - 2020-05-03_202356＿.jpg \n 2020-05-03_203418＿.jpg \n 2020-05-03_211131＿.jpg \n 2020-05-03_213853＿.jpg https://t.co/BcMNbuXBjl

　スマホで撮影していた写真をみると，5月3日の18時08分は買い物から戻ったところで，再びBIOSが起動したのが19時42分でした。19時52分にはWindows10を起動しています。

　Ubuntuの起動時のメッセージは，矢印キーを押してみると表示され，1分30秒のカウントダウンとなっていました。カーネルのあるパーティションのUUIDに接続を試みているようでした。メッセージで検索すると，それらしい情報があり，解決のヒントとなりました。

▶▶▶　kk_hironoのリツイート　▶▶▶  

- RT kk_hirono（告発＼市場急配センター殺人未遂事件＼金沢地方検察庁・石川県警察御中）｜hirono_hideki（奉納＼さらば弁護士鉄道・泥棒神社の物語） 日時：2020-05-05 16:22／2020/05/03 21:33 URL： https://twitter.com/kk_hirono/status/1257571464632360961 https://twitter.com/hirono_hideki/status/1256924853581410304  

> ようやく正常起動した様子のUbuntu20.04。  

▶▶▶　kk_hironoのリツイート　▶▶▶  

- RT kk_hirono（告発＼市場急配センター殺人未遂事件＼金沢地方検察庁・石川県警察御中）｜hirono_hideki（奉納＼さらば弁護士鉄道・泥棒神社の物語） 日時：2020-05-05 16:22／2020/05/03 20:42 URL： https://twitter.com/kk_hirono/status/1257571314954416130 https://twitter.com/hirono_hideki/status/1256911990041096192  

> Ubuntuでa start job is running for dev-desk-by ...とかでて起動が遅い - くれなゐの雑記 https://t.co/4ZEnjx8vVT  

▶▶▶　kk_hironoのリツイート　▶▶▶  

- RT kk_hirono（告発＼市場急配センター殺人未遂事件＼金沢地方検察庁・石川県警察御中）｜hirono_hideki（奉納＼さらば弁護士鉄道・泥棒神社の物語） 日時：2020-05-05 16:22／2020/05/03 20:36 URL： https://twitter.com/kk_hirono/status/1257571294045827073 https://twitter.com/hirono_hideki/status/1256910589579767808  

> a start job is running for - Google 検索 https://t.co/EZBnr53YHE  

　2020-05-03_213853にノートパソコンでUbuntu20.04のインストールを始めていますが，このときは失敗をしました。EFIシステムパーティションの作成を忘れていたからです。

　ノートパソコンに取り付けていたハードディスクですが，SSDを外付けするために購入していたUSB接続のケースに入れてつないでみたところ，他のパソコンでも普通にファイルの読み書きが出来ました。SSDという固定観念があったのですが，どちらも同じだったみたいです。

　前日か前々日にディスクトップパソコンでも同じUbuntu20.04をインストールしていたので，SSHで遠隔ログインしながら，コマンド履歴をコピペするなどして，アプリのインストールや設定を行いました。設定はそのままコピーが多いです。

　Ubuntuの場合はaptになりますが，ほとんどがコマンドラインからのインストール作業になるので，インストールする側のパソコンはディスプレイも不要になります。DVDを入れ替えながらアプリをインストールするということはほとんどないと思います。

　アプリの設定ファイルがテキストファイルになっていることが多いのもLinuxの特徴です。使い回しのできることが多いですが，環境の変化などでメンテナンスの対処を迫られることも少なくありません。バージョンが上がると設定の書式が変わることもあります。

　昨日の5月4日の朝になりますが，前のUbuntu18.04の環境では普通に使えていたpandocのPDFファイル変換で，--latex-engine=lualatexというオプションが使えなくなっていました。削除されたような意味の英語のメッセージが出ていました。

　これで本文のみのPDFファイルの作成しかできなくなり，他に方法を探したのですが見つからず，仕方がないので自分でMarkdownからPDFファイルを一挙に作成するスプリクトの作成を始めました。これも思いの外，手間取ったのですが，一応出来上がっています。

